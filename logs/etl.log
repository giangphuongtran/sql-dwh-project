2025-06-26 01:14:24,292 | INFO | Starting ETL script.
2025-06-26 01:14:24,292 | INFO | Environment variables loaded successfully.
2025-06-26 01:14:24,292 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-26 01:14:24,339 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-26 01:14:24,339 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-26 01:14:24,340 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-26 01:14:24,340 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-26 01:14:27,793 | INFO | Spark Session created successfully.
2025-06-26 01:14:27,794 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-26 01:14:27,805 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-26 01:14:27,805 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 01:14:27,806 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-26 01:14:27,806 | INFO |   spark.master: local[*]
2025-06-26 01:14:27,807 | INFO |   spark.driver.port: 43017
2025-06-26 01:14:27,807 | INFO |   spark.executor.id: driver
2025-06-26 01:14:27,807 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-26 01:14:27,808 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-26 01:14:27,808 | INFO |   spark.submit.deployMode: client
2025-06-26 01:14:27,808 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-26 01:14:27,808 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-26 01:14:27,809 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-26 01:14:27,809 | INFO |   spark.ui.showConsoleProgress: true
2025-06-26 01:14:27,809 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 01:14:27,809 | INFO |   spark.app.startTime: 1750875265857
2025-06-26 01:14:27,809 | INFO |   spark.rdd.compress: True
2025-06-26 01:14:27,809 | INFO |   spark.driver.host: a13a1775bf4a
2025-06-26 01:14:27,810 | INFO |   spark.app.submitTime: 1750875265664
2025-06-26 01:14:27,810 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-26 01:14:27,811 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-26 01:14:27,812 | INFO |   spark.app.initial.jar.urls: spark://a13a1775bf4a:43017/jars/postgresql-42.6.0.jar
2025-06-26 01:14:27,812 | INFO |   spark.submit.pyFiles: 
2025-06-26 01:14:27,812 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-26 01:14:27,813 | INFO |   spark.app.id: local-1750875266310
2025-06-26 01:14:27,813 | INFO | --- End Spark Configurations ---
2025-06-26 01:14:27,813 | INFO | Starting CSV ingestion...
2025-06-26 01:14:27,813 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-26 01:14:27,813 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-26 01:14:27,814 | INFO | 
Processing folder: source_crm
2025-06-26 01:14:27,814 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-26 01:14:27,815 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-26 01:14:27,815 | INFO | Attempting to process file: cust_info.csv
2025-06-26 01:14:27,815 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-26 01:14:27,816 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-26 01:14:27,816 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-26 01:14:29,855 | INFO |     Successfully read cust_info.csv. DataFrame schema inferred. (First 5 rows for quick check, avoid df.show() for large data):
2025-06-26 01:14:29,855 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-26 01:14:30,722 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-26 01:14:30,722 | INFO | Attempting to process file: prd_info.csv
2025-06-26 01:14:30,722 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-26 01:14:30,723 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-26 01:14:30,723 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-26 01:14:30,909 | INFO |     Successfully read prd_info.csv. DataFrame schema inferred. (First 5 rows for quick check, avoid df.show() for large data):
2025-06-26 01:14:30,910 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-26 01:14:31,081 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-26 01:14:31,081 | INFO | Attempting to process file: sales_details.csv
2025-06-26 01:14:31,081 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-26 01:14:31,081 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-26 01:14:31,081 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-26 01:14:31,392 | INFO |     Successfully read sales_details.csv. DataFrame schema inferred. (First 5 rows for quick check, avoid df.show() for large data):
2025-06-26 01:14:31,392 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-26 01:14:32,023 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-26 01:14:32,024 | INFO | 
Processing folder: source_erp
2025-06-26 01:14:32,024 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-26 01:14:32,025 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-26 01:14:32,025 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-26 01:14:32,025 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 01:14:32,025 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-26 01:14:32,025 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 01:14:32,162 | INFO |     Successfully read CUST_AZ12.csv. DataFrame schema inferred. (First 5 rows for quick check, avoid df.show() for large data):
2025-06-26 01:14:32,163 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-26 01:14:32,388 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-26 01:14:32,388 | INFO | Attempting to process file: LOC_A101.csv
2025-06-26 01:14:32,388 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 01:14:32,388 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-26 01:14:32,388 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 01:14:32,491 | INFO |     Successfully read LOC_A101.csv. DataFrame schema inferred. (First 5 rows for quick check, avoid df.show() for large data):
2025-06-26 01:14:32,491 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-26 01:14:32,714 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-26 01:14:32,715 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-26 01:14:32,715 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 01:14:32,715 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-26 01:14:32,715 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 01:14:32,799 | INFO |     Successfully read PX_CAT_G1V2.csv. DataFrame schema inferred. (First 5 rows for quick check, avoid df.show() for large data):
2025-06-26 01:14:32,800 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-26 01:14:32,898 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-26 01:14:32,898 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-26 01:14:33,093 | INFO | Spark Session stopped.
2025-06-26 01:18:56,404 | INFO | Starting ETL script.
2025-06-26 01:18:56,406 | INFO | Environment variables loaded successfully.
2025-06-26 01:18:56,406 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-26 01:18:56,439 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-26 01:18:56,439 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-26 01:18:56,439 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-26 01:18:56,440 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-26 01:18:59,781 | INFO | Spark Session created successfully.
2025-06-26 01:18:59,782 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-26 01:18:59,795 | INFO |   spark.app.startTime: 1750875537850
2025-06-26 01:18:59,795 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-26 01:18:59,796 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 01:18:59,796 | INFO |   spark.app.initial.jar.urls: spark://cfe2a5196132:39679/jars/postgresql-42.6.0.jar
2025-06-26 01:18:59,796 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-26 01:18:59,797 | INFO |   spark.master: local[*]
2025-06-26 01:18:59,797 | INFO |   spark.executor.id: driver
2025-06-26 01:18:59,797 | INFO |   spark.driver.host: cfe2a5196132
2025-06-26 01:18:59,797 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-26 01:18:59,798 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-26 01:18:59,798 | INFO |   spark.submit.deployMode: client
2025-06-26 01:18:59,798 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-26 01:18:59,798 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-26 01:18:59,799 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-26 01:18:59,799 | INFO |   spark.app.submitTime: 1750875537684
2025-06-26 01:18:59,800 | INFO |   spark.ui.showConsoleProgress: true
2025-06-26 01:18:59,800 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 01:18:59,800 | INFO |   spark.driver.port: 39679
2025-06-26 01:18:59,801 | INFO |   spark.rdd.compress: True
2025-06-26 01:18:59,801 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-26 01:18:59,801 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-26 01:18:59,802 | INFO |   spark.submit.pyFiles: 
2025-06-26 01:18:59,802 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-26 01:18:59,802 | INFO |   spark.app.id: local-1750875538306
2025-06-26 01:18:59,802 | INFO | --- End Spark Configurations ---
2025-06-26 01:18:59,802 | INFO | Starting CSV ingestion...
2025-06-26 01:18:59,803 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-26 01:18:59,803 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-26 01:18:59,803 | INFO | 
Processing folder: source_crm
2025-06-26 01:18:59,803 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-26 01:18:59,806 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-26 01:18:59,806 | INFO | Attempting to process file: cust_info.csv
2025-06-26 01:18:59,806 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-26 01:18:59,807 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-26 01:18:59,807 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-26 01:19:01,911 | INFO |     Successfully read cust_info.csv.
2025-06-26 01:19:01,915 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-26 01:19:02,833 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-26 01:19:02,833 | INFO | Attempting to process file: prd_info.csv
2025-06-26 01:19:02,834 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-26 01:19:02,834 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-26 01:19:02,834 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-26 01:19:03,014 | INFO |     Successfully read prd_info.csv.
2025-06-26 01:19:03,014 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-26 01:19:03,213 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-26 01:19:03,213 | INFO | Attempting to process file: sales_details.csv
2025-06-26 01:19:03,213 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-26 01:19:03,214 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-26 01:19:03,214 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-26 01:19:03,472 | INFO |     Successfully read sales_details.csv.
2025-06-26 01:19:03,472 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-26 01:19:04,080 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-26 01:19:04,081 | INFO | 
Processing folder: source_erp
2025-06-26 01:19:04,081 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-26 01:19:04,082 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-26 01:19:04,082 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-26 01:19:04,082 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 01:19:04,082 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-26 01:19:04,083 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 01:19:04,246 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-26 01:19:04,247 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-26 01:19:04,519 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-26 01:19:04,520 | INFO | Attempting to process file: LOC_A101.csv
2025-06-26 01:19:04,520 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 01:19:04,520 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-26 01:19:04,521 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 01:19:04,640 | INFO |     Successfully read LOC_A101.csv.
2025-06-26 01:19:04,640 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-26 01:19:04,824 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-26 01:19:04,825 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-26 01:19:04,825 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 01:19:04,825 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-26 01:19:04,825 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 01:19:04,944 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-26 01:19:04,944 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-26 01:19:05,035 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-26 01:19:05,035 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-26 01:19:05,093 | INFO | Spark Session stopped.
2025-06-26 21:58:03,352 | INFO | Starting ETL script.
2025-06-26 21:58:03,353 | INFO | Environment variables loaded successfully.
2025-06-26 21:58:03,353 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-26 21:58:03,439 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-26 21:58:03,439 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-26 21:58:03,440 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-26 21:58:03,440 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-26 21:58:07,409 | INFO | Spark Session created successfully.
2025-06-26 21:58:07,409 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-26 21:58:07,423 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-26 21:58:07,424 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 21:58:07,424 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-26 21:58:07,424 | INFO |   spark.master: local[*]
2025-06-26 21:58:07,424 | INFO |   spark.executor.id: driver
2025-06-26 21:58:07,424 | INFO |   spark.driver.host: cfe2a5196132
2025-06-26 21:58:07,425 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-26 21:58:07,425 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-26 21:58:07,425 | INFO |   spark.submit.deployMode: client
2025-06-26 21:58:07,425 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-26 21:58:07,425 | INFO |   spark.driver.port: 35095
2025-06-26 21:58:07,426 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-26 21:58:07,426 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-26 21:58:07,426 | INFO |   spark.app.initial.jar.urls: spark://cfe2a5196132:35095/jars/postgresql-42.6.0.jar
2025-06-26 21:58:07,426 | INFO |   spark.ui.showConsoleProgress: true
2025-06-26 21:58:07,426 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 21:58:07,426 | INFO |   spark.rdd.compress: True
2025-06-26 21:58:07,427 | INFO |   spark.app.submitTime: 1750949885050
2025-06-26 21:58:07,427 | INFO |   spark.app.id: local-1750949885767
2025-06-26 21:58:07,427 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-26 21:58:07,427 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-26 21:58:07,427 | INFO |   spark.submit.pyFiles: 
2025-06-26 21:58:07,428 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-26 21:58:07,428 | INFO |   spark.app.startTime: 1750949885258
2025-06-26 21:58:07,428 | INFO | --- End Spark Configurations ---
2025-06-26 21:58:07,428 | INFO | Starting CSV ingestion...
2025-06-26 21:58:07,428 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-26 21:58:07,428 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-26 21:58:07,429 | INFO | 
Processing folder: source_crm
2025-06-26 21:58:07,429 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-26 21:58:07,430 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-26 21:58:07,431 | INFO | Attempting to process file: cust_info.csv
2025-06-26 21:58:07,432 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-26 21:58:07,433 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-26 21:58:07,433 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-26 21:58:09,457 | INFO |     Successfully read cust_info.csv.
2025-06-26 21:58:09,457 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-26 21:58:10,333 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-26 21:58:10,333 | INFO | Attempting to process file: prd_info.csv
2025-06-26 21:58:10,333 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-26 21:58:10,334 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-26 21:58:10,334 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-26 21:58:10,563 | INFO |     Successfully read prd_info.csv.
2025-06-26 21:58:10,563 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-26 21:58:10,727 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-26 21:58:10,727 | INFO | Attempting to process file: sales_details.csv
2025-06-26 21:58:10,727 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-26 21:58:10,728 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-26 21:58:10,728 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-26 21:58:10,983 | INFO |     Successfully read sales_details.csv.
2025-06-26 21:58:10,983 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-26 21:58:11,503 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-26 21:58:11,504 | INFO | 
Processing folder: source_erp
2025-06-26 21:58:11,505 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-26 21:58:11,506 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-26 21:58:11,507 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-26 21:58:11,507 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 21:58:11,509 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-26 21:58:11,509 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 21:58:11,685 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-26 21:58:11,685 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-26 21:58:11,940 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-26 21:58:11,940 | INFO | Attempting to process file: LOC_A101.csv
2025-06-26 21:58:11,940 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 21:58:11,941 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-26 21:58:11,941 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 21:58:12,040 | INFO |     Successfully read LOC_A101.csv.
2025-06-26 21:58:12,040 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-26 21:58:12,206 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-26 21:58:12,206 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-26 21:58:12,206 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 21:58:12,206 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-26 21:58:12,206 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 21:58:12,306 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-26 21:58:12,306 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-26 21:58:12,387 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-26 21:58:12,387 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-26 21:58:12,591 | INFO | Spark Session stopped.
2025-06-26 22:36:18,733 | INFO | Starting ETL script.
2025-06-26 22:36:18,734 | INFO | Environment variables loaded successfully.
2025-06-26 22:36:18,734 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-26 22:36:18,766 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-26 22:36:18,767 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-26 22:36:18,767 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-26 22:36:18,767 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-26 22:36:21,888 | INFO | Spark Session created successfully.
2025-06-26 22:36:21,889 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-26 22:36:21,898 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-26 22:36:21,898 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 22:36:21,898 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-26 22:36:21,898 | INFO |   spark.app.startTime: 1750952180094
2025-06-26 22:36:21,899 | INFO |   spark.master: local[*]
2025-06-26 22:36:21,899 | INFO |   spark.executor.id: driver
2025-06-26 22:36:21,899 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-26 22:36:21,899 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-26 22:36:21,899 | INFO |   spark.submit.deployMode: client
2025-06-26 22:36:21,899 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-26 22:36:21,899 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-26 22:36:21,899 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-26 22:36:21,900 | INFO |   spark.app.id: local-1750952180505
2025-06-26 22:36:21,900 | INFO |   spark.ui.showConsoleProgress: true
2025-06-26 22:36:21,900 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 22:36:21,900 | INFO |   spark.driver.port: 46429
2025-06-26 22:36:21,900 | INFO |   spark.rdd.compress: True
2025-06-26 22:36:21,900 | INFO |   spark.driver.host: b5c7438f8d1c
2025-06-26 22:36:21,900 | INFO |   spark.app.initial.jar.urls: spark://b5c7438f8d1c:46429/jars/postgresql-42.6.0.jar
2025-06-26 22:36:21,900 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-26 22:36:21,900 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-26 22:36:21,901 | INFO |   spark.submit.pyFiles: 
2025-06-26 22:36:21,901 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-26 22:36:21,901 | INFO |   spark.app.submitTime: 1750952179944
2025-06-26 22:36:21,901 | INFO | --- End Spark Configurations ---
2025-06-26 22:36:21,901 | INFO | Starting CSV ingestion...
2025-06-26 22:36:21,901 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-26 22:36:21,901 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-26 22:36:21,901 | INFO | 
Processing folder: source_crm
2025-06-26 22:36:21,901 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-26 22:36:21,902 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-26 22:36:21,902 | INFO | Attempting to process file: cust_info.csv
2025-06-26 22:36:21,902 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-26 22:36:21,902 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-26 22:36:21,902 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-26 22:36:23,883 | INFO |     Successfully read cust_info.csv.
2025-06-26 22:36:23,883 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-26 22:36:24,699 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-26 22:36:24,699 | INFO | Attempting to process file: prd_info.csv
2025-06-26 22:36:24,699 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-26 22:36:24,700 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-26 22:36:24,700 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-26 22:36:24,883 | INFO |     Successfully read prd_info.csv.
2025-06-26 22:36:24,883 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-26 22:36:25,057 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-26 22:36:25,057 | INFO | Attempting to process file: sales_details.csv
2025-06-26 22:36:25,058 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-26 22:36:25,058 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-26 22:36:25,060 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-26 22:36:25,288 | INFO |     Successfully read sales_details.csv.
2025-06-26 22:36:25,288 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-26 22:36:25,805 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-26 22:36:25,805 | INFO | 
Processing folder: source_erp
2025-06-26 22:36:25,805 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-26 22:36:25,806 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-26 22:36:25,806 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-26 22:36:25,806 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 22:36:25,807 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-26 22:36:25,807 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 22:36:25,964 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-26 22:36:25,964 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-26 22:36:26,207 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-26 22:36:26,207 | INFO | Attempting to process file: LOC_A101.csv
2025-06-26 22:36:26,208 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 22:36:26,208 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-26 22:36:26,208 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 22:36:26,304 | INFO |     Successfully read LOC_A101.csv.
2025-06-26 22:36:26,304 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-26 22:36:26,473 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-26 22:36:26,473 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-26 22:36:26,473 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 22:36:26,473 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-26 22:36:26,474 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 22:36:26,570 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-26 22:36:26,571 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-26 22:36:26,648 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-26 22:36:26,648 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-26 22:36:26,766 | INFO | Spark Session stopped.
2025-06-26 22:36:59,780 | INFO | Starting ETL script.
2025-06-26 22:36:59,780 | INFO | Environment variables loaded successfully.
2025-06-26 22:36:59,780 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-26 22:36:59,810 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-26 22:36:59,810 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-26 22:36:59,811 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-26 22:36:59,811 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-26 22:37:02,771 | INFO | Spark Session created successfully.
2025-06-26 22:37:02,772 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-26 22:37:02,781 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-26 22:37:02,781 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 22:37:02,782 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-26 22:37:02,782 | INFO |   spark.master: local[*]
2025-06-26 22:37:02,782 | INFO |   spark.executor.id: driver
2025-06-26 22:37:02,782 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-26 22:37:02,782 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-26 22:37:02,783 | INFO |   spark.app.submitTime: 1750952220868
2025-06-26 22:37:02,783 | INFO |   spark.submit.deployMode: client
2025-06-26 22:37:02,783 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-26 22:37:02,783 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-26 22:37:02,783 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-26 22:37:02,783 | INFO |   spark.app.id: local-1750952221405
2025-06-26 22:37:02,784 | INFO |   spark.ui.showConsoleProgress: true
2025-06-26 22:37:02,784 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-26 22:37:02,784 | INFO |   spark.rdd.compress: True
2025-06-26 22:37:02,784 | INFO |   spark.driver.host: fb76c910b2cf
2025-06-26 22:37:02,784 | INFO |   spark.app.initial.jar.urls: spark://fb76c910b2cf:35725/jars/postgresql-42.6.0.jar
2025-06-26 22:37:02,784 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-26 22:37:02,784 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-26 22:37:02,785 | INFO |   spark.driver.port: 35725
2025-06-26 22:37:02,785 | INFO |   spark.submit.pyFiles: 
2025-06-26 22:37:02,785 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-26 22:37:02,785 | INFO |   spark.app.startTime: 1750952221014
2025-06-26 22:37:02,785 | INFO | --- End Spark Configurations ---
2025-06-26 22:37:02,785 | INFO | Starting CSV ingestion...
2025-06-26 22:37:02,785 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-26 22:37:02,785 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-26 22:37:02,786 | INFO | 
Processing folder: source_crm
2025-06-26 22:37:02,786 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-26 22:37:02,789 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-26 22:37:02,790 | INFO | Attempting to process file: cust_info.csv
2025-06-26 22:37:02,790 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-26 22:37:02,790 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-26 22:37:02,791 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-26 22:37:04,660 | INFO |     Successfully read cust_info.csv.
2025-06-26 22:37:04,660 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-26 22:37:05,552 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-26 22:37:05,553 | INFO | Attempting to process file: prd_info.csv
2025-06-26 22:37:05,553 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-26 22:37:05,553 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-26 22:37:05,553 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-26 22:37:05,701 | INFO |     Successfully read prd_info.csv.
2025-06-26 22:37:05,701 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-26 22:37:05,905 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-26 22:37:05,906 | INFO | Attempting to process file: sales_details.csv
2025-06-26 22:37:05,906 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-26 22:37:05,906 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-26 22:37:05,907 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-26 22:37:06,149 | INFO |     Successfully read sales_details.csv.
2025-06-26 22:37:06,149 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-26 22:37:06,709 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-26 22:37:06,709 | INFO | 
Processing folder: source_erp
2025-06-26 22:37:06,709 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-26 22:37:06,710 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-26 22:37:06,711 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-26 22:37:06,711 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 22:37:06,711 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-26 22:37:06,711 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-26 22:37:06,829 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-26 22:37:06,829 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-26 22:37:07,088 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-26 22:37:07,098 | INFO | Attempting to process file: LOC_A101.csv
2025-06-26 22:37:07,098 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 22:37:07,098 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-26 22:37:07,100 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-26 22:37:07,212 | INFO |     Successfully read LOC_A101.csv.
2025-06-26 22:37:07,212 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-26 22:37:07,446 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-26 22:37:07,446 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-26 22:37:07,447 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 22:37:07,447 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-26 22:37:07,447 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-26 22:37:07,536 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-26 22:37:07,536 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-26 22:37:07,619 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-26 22:37:07,620 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-26 22:37:07,620 | INFO | Starting to create empty tables in 'silver' schema...
2025-06-26 22:37:07,620 | INFO | Reading schema from bronze.crm_cust_info...
2025-06-26 22:37:07,634 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-06-26 22:37:07,690 | INFO | Empty table created: silver.crm_cust_info
2025-06-26 22:37:07,691 | INFO | Reading schema from bronze.crm_prd_info...
2025-06-26 22:37:07,714 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-06-26 22:37:07,777 | INFO | Empty table created: silver.crm_prd_info
2025-06-26 22:37:07,777 | INFO | Reading schema from bronze.crm_sales_details...
2025-06-26 22:37:07,800 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-06-26 22:37:07,861 | INFO | Empty table created: silver.crm_sales_details
2025-06-26 22:37:07,861 | INFO | Reading schema from bronze.erp_cust_info...
2025-06-26 22:37:07,873 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-06-26 22:37:07,913 | INFO | Empty table created: silver.erp_cust_info
2025-06-26 22:37:07,913 | INFO | Reading schema from bronze.erp_loc_info...
2025-06-26 22:37:07,925 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-06-26 22:37:07,964 | INFO | Empty table created: silver.erp_loc_info
2025-06-26 22:37:07,964 | INFO | Reading schema from bronze.erp_px_cat...
2025-06-26 22:37:07,986 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-06-26 22:37:08,029 | INFO | Empty table created: silver.erp_px_cat
2025-06-26 22:37:08,178 | INFO | Spark Session stopped.
2025-06-27 20:50:56,337 | INFO | RUN_INGEST is false. Skipping ingestion.
2025-06-29 11:28:57,663 | INFO | Starting ETL script.
2025-06-29 11:28:57,664 | INFO | Environment variables loaded successfully.
2025-06-29 11:28:57,664 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-29 11:28:57,752 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-29 11:28:57,753 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-29 11:28:57,753 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-29 11:28:57,754 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-29 11:29:01,944 | INFO | Spark Session created successfully.
2025-06-29 11:29:01,944 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-29 11:29:01,956 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-29 11:29:01,956 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 11:29:01,956 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-29 11:29:01,956 | INFO |   spark.master: local[*]
2025-06-29 11:29:01,957 | INFO |   spark.executor.id: driver
2025-06-29 11:29:01,957 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-29 11:29:01,957 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-29 11:29:01,957 | INFO |   spark.submit.deployMode: client
2025-06-29 11:29:01,957 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-29 11:29:01,958 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-29 11:29:01,958 | INFO |   spark.app.startTime: 1751171339687
2025-06-29 11:29:01,958 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-29 11:29:01,958 | INFO |   spark.ui.showConsoleProgress: true
2025-06-29 11:29:01,958 | INFO |   spark.driver.host: adbdb5ed2b37
2025-06-29 11:29:01,958 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 11:29:01,958 | INFO |   spark.rdd.compress: True
2025-06-29 11:29:01,958 | INFO |   spark.app.submitTime: 1751171339442
2025-06-29 11:29:01,958 | INFO |   spark.app.initial.jar.urls: spark://adbdb5ed2b37:46851/jars/postgresql-42.6.0.jar
2025-06-29 11:29:01,959 | INFO |   spark.driver.port: 46851
2025-06-29 11:29:01,959 | INFO |   spark.app.id: local-1751171340214
2025-06-29 11:29:01,961 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-29 11:29:01,962 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-29 11:29:01,962 | INFO |   spark.submit.pyFiles: 
2025-06-29 11:29:01,963 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-29 11:29:01,963 | INFO | --- End Spark Configurations ---
2025-06-29 11:29:01,963 | INFO | Starting CSV ingestion...
2025-06-29 11:29:01,963 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-29 11:29:01,963 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-29 11:29:01,964 | INFO | 
Processing folder: source_crm
2025-06-29 11:29:01,964 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-29 11:29:01,969 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-29 11:29:01,969 | INFO | Attempting to process file: cust_info.csv
2025-06-29 11:29:01,969 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-29 11:29:01,969 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-29 11:29:01,976 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-29 11:29:04,308 | INFO |     Successfully read cust_info.csv.
2025-06-29 11:29:04,309 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-29 11:29:05,194 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-29 11:29:05,194 | INFO | Attempting to process file: prd_info.csv
2025-06-29 11:29:05,194 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-29 11:29:05,194 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-29 11:29:05,195 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-29 11:29:05,329 | INFO |     Successfully read prd_info.csv.
2025-06-29 11:29:05,329 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-29 11:29:05,504 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-29 11:29:05,505 | INFO | Attempting to process file: sales_details.csv
2025-06-29 11:29:05,506 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-29 11:29:05,506 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-29 11:29:05,506 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-29 11:29:05,727 | INFO |     Successfully read sales_details.csv.
2025-06-29 11:29:05,727 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-29 11:29:06,368 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-29 11:29:06,368 | INFO | 
Processing folder: source_erp
2025-06-29 11:29:06,368 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-29 11:29:06,369 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-29 11:29:06,369 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-29 11:29:06,369 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 11:29:06,369 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-29 11:29:06,370 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 11:29:06,513 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-29 11:29:06,514 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-29 11:29:06,767 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-29 11:29:06,767 | INFO | Attempting to process file: LOC_A101.csv
2025-06-29 11:29:06,767 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 11:29:06,767 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-29 11:29:06,767 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 11:29:06,890 | INFO |     Successfully read LOC_A101.csv.
2025-06-29 11:29:06,890 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-29 11:29:07,119 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-29 11:29:07,119 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-29 11:29:07,119 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 11:29:07,119 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-29 11:29:07,120 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 11:29:07,216 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-29 11:29:07,216 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-29 11:29:07,356 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-29 11:29:07,356 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-29 11:29:07,356 | INFO | Starting to create empty tables in 'silver' schema...
2025-06-29 11:29:07,356 | INFO | Reading schema from bronze.crm_cust_info...
2025-06-29 11:29:07,379 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-06-29 11:29:07,426 | INFO | Empty table created: silver.crm_cust_info
2025-06-29 11:29:07,426 | INFO | Reading schema from bronze.crm_prd_info...
2025-06-29 11:29:07,442 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-06-29 11:29:07,485 | INFO | Empty table created: silver.crm_prd_info
2025-06-29 11:29:07,485 | INFO | Reading schema from bronze.crm_sales_details...
2025-06-29 11:29:07,503 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-06-29 11:29:07,553 | INFO | Empty table created: silver.crm_sales_details
2025-06-29 11:29:07,554 | INFO | Reading schema from bronze.erp_cust_info...
2025-06-29 11:29:07,568 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-06-29 11:29:07,612 | INFO | Empty table created: silver.erp_cust_info
2025-06-29 11:29:07,612 | INFO | Reading schema from bronze.erp_loc_info...
2025-06-29 11:29:07,628 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-06-29 11:29:07,672 | INFO | Empty table created: silver.erp_loc_info
2025-06-29 11:29:07,673 | INFO | Reading schema from bronze.erp_px_cat...
2025-06-29 11:29:07,688 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-06-29 11:29:07,729 | INFO | Empty table created: silver.erp_px_cat
2025-06-29 11:29:08,057 | INFO | Spark Session stopped.
2025-06-29 11:30:09,740 | INFO | Starting ETL script.
2025-06-29 11:30:09,740 | INFO | Environment variables loaded successfully.
2025-06-29 11:30:09,740 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-29 11:30:09,771 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-29 11:30:09,772 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-29 11:30:09,772 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-29 11:30:09,772 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-29 11:30:12,763 | INFO | Spark Session created successfully.
2025-06-29 11:30:12,763 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-29 11:30:12,774 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-29 11:30:12,774 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 11:30:12,774 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-29 11:30:12,774 | INFO |   spark.master: local[*]
2025-06-29 11:30:12,775 | INFO |   spark.driver.host: 4161df956968
2025-06-29 11:30:12,775 | INFO |   spark.executor.id: driver
2025-06-29 11:30:12,775 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-29 11:30:12,775 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-29 11:30:12,775 | INFO |   spark.submit.deployMode: client
2025-06-29 11:30:12,775 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-29 11:30:12,775 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-29 11:30:12,775 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-29 11:30:12,775 | INFO |   spark.driver.port: 43727
2025-06-29 11:30:12,776 | INFO |   spark.ui.showConsoleProgress: true
2025-06-29 11:30:12,776 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 11:30:12,776 | INFO |   spark.rdd.compress: True
2025-06-29 11:30:12,776 | INFO |   spark.app.initial.jar.urls: spark://4161df956968:43727/jars/postgresql-42.6.0.jar
2025-06-29 11:30:12,776 | INFO |   spark.app.submitTime: 1751171410799
2025-06-29 11:30:12,776 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-29 11:30:12,776 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-29 11:30:12,776 | INFO |   spark.submit.pyFiles: 
2025-06-29 11:30:12,776 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-29 11:30:12,776 | INFO |   spark.app.id: local-1751171411390
2025-06-29 11:30:12,776 | INFO |   spark.app.startTime: 1751171410979
2025-06-29 11:30:12,777 | INFO | --- End Spark Configurations ---
2025-06-29 11:30:12,777 | INFO | Starting CSV ingestion...
2025-06-29 11:30:12,777 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-29 11:30:12,777 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-29 11:30:12,777 | INFO | 
Processing folder: source_crm
2025-06-29 11:30:12,777 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-29 11:30:12,778 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-29 11:30:12,778 | INFO | Attempting to process file: cust_info.csv
2025-06-29 11:30:12,778 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-29 11:30:12,778 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-29 11:30:12,778 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-29 11:30:14,655 | INFO |     Successfully read cust_info.csv.
2025-06-29 11:30:14,655 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-29 11:30:15,472 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-29 11:30:15,472 | INFO | Attempting to process file: prd_info.csv
2025-06-29 11:30:15,472 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-29 11:30:15,472 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-29 11:30:15,472 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-29 11:30:15,650 | INFO |     Successfully read prd_info.csv.
2025-06-29 11:30:15,651 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-29 11:30:15,836 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-29 11:30:15,836 | INFO | Attempting to process file: sales_details.csv
2025-06-29 11:30:15,837 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-29 11:30:15,837 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-29 11:30:15,838 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-29 11:30:16,075 | INFO |     Successfully read sales_details.csv.
2025-06-29 11:30:16,076 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-29 11:30:16,715 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-29 11:30:16,715 | INFO | 
Processing folder: source_erp
2025-06-29 11:30:16,715 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-29 11:30:16,716 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-29 11:30:16,716 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-29 11:30:16,716 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 11:30:16,716 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-29 11:30:16,717 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 11:30:16,894 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-29 11:30:16,897 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-29 11:30:17,174 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-29 11:30:17,175 | INFO | Attempting to process file: LOC_A101.csv
2025-06-29 11:30:17,175 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 11:30:17,175 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-29 11:30:17,176 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 11:30:17,308 | INFO |     Successfully read LOC_A101.csv.
2025-06-29 11:30:17,308 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-29 11:30:17,555 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-29 11:30:17,556 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-29 11:30:17,557 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 11:30:17,557 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-29 11:30:17,557 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 11:30:17,676 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-29 11:30:17,677 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-29 11:30:17,796 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-29 11:30:17,796 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-29 11:30:17,797 | INFO | Starting to create empty tables in 'silver' schema...
2025-06-29 11:30:17,797 | INFO | Reading schema from bronze.crm_cust_info...
2025-06-29 11:30:17,815 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-06-29 11:30:17,858 | INFO | Empty table created: silver.crm_cust_info
2025-06-29 11:30:17,858 | INFO | Reading schema from bronze.crm_prd_info...
2025-06-29 11:30:17,874 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-06-29 11:30:17,913 | INFO | Empty table created: silver.crm_prd_info
2025-06-29 11:30:17,913 | INFO | Reading schema from bronze.crm_sales_details...
2025-06-29 11:30:17,929 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-06-29 11:30:17,974 | INFO | Empty table created: silver.crm_sales_details
2025-06-29 11:30:17,974 | INFO | Reading schema from bronze.erp_cust_info...
2025-06-29 11:30:17,988 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-06-29 11:30:18,024 | INFO | Empty table created: silver.erp_cust_info
2025-06-29 11:30:18,024 | INFO | Reading schema from bronze.erp_loc_info...
2025-06-29 11:30:18,038 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-06-29 11:30:18,092 | INFO | Empty table created: silver.erp_loc_info
2025-06-29 11:30:18,092 | INFO | Reading schema from bronze.erp_px_cat...
2025-06-29 11:30:18,108 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-06-29 11:30:18,153 | INFO | Empty table created: silver.erp_px_cat
2025-06-29 11:30:18,658 | INFO | Spark Session stopped.
2025-06-29 11:33:35,200 | INFO | Starting ETL script.
2025-06-29 11:33:35,201 | INFO | Environment variables loaded successfully.
2025-06-29 11:33:35,201 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-29 11:33:35,232 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-29 11:33:35,233 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-29 11:33:35,233 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-29 11:33:35,233 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-29 11:33:38,331 | INFO | Spark Session created successfully.
2025-06-29 11:33:38,331 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-29 11:33:38,342 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-29 11:33:38,343 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 11:33:38,343 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-29 11:33:38,343 | INFO |   spark.master: local[*]
2025-06-29 11:33:38,343 | INFO |   spark.app.id: local-1751171616960
2025-06-29 11:33:38,343 | INFO |   spark.executor.id: driver
2025-06-29 11:33:38,343 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-29 11:33:38,343 | INFO |   spark.driver.port: 34341
2025-06-29 11:33:38,344 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-29 11:33:38,344 | INFO |   spark.submit.deployMode: client
2025-06-29 11:33:38,344 | INFO |   spark.app.initial.jar.urls: spark://6b7076e30276:34341/jars/postgresql-42.6.0.jar
2025-06-29 11:33:38,344 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-29 11:33:38,344 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-29 11:33:38,344 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-29 11:33:38,344 | INFO |   spark.app.startTime: 1751171616537
2025-06-29 11:33:38,344 | INFO |   spark.ui.showConsoleProgress: true
2025-06-29 11:33:38,345 | INFO |   spark.driver.host: 6b7076e30276
2025-06-29 11:33:38,345 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 11:33:38,345 | INFO |   spark.rdd.compress: True
2025-06-29 11:33:38,345 | INFO |   spark.app.submitTime: 1751171616335
2025-06-29 11:33:38,345 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-29 11:33:38,345 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-29 11:33:38,346 | INFO |   spark.submit.pyFiles: 
2025-06-29 11:33:38,346 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-29 11:33:38,346 | INFO | --- End Spark Configurations ---
2025-06-29 11:33:38,346 | INFO | Starting CSV ingestion...
2025-06-29 11:33:38,346 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-29 11:33:38,346 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-29 11:33:38,346 | INFO | 
Processing folder: source_crm
2025-06-29 11:33:38,346 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-29 11:33:38,347 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-29 11:33:38,347 | INFO | Attempting to process file: cust_info.csv
2025-06-29 11:33:38,347 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-29 11:33:38,347 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-29 11:33:38,347 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-29 11:33:40,267 | INFO |     Successfully read cust_info.csv.
2025-06-29 11:33:40,267 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-29 11:33:41,196 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-29 11:33:41,196 | INFO | Attempting to process file: prd_info.csv
2025-06-29 11:33:41,196 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-29 11:33:41,196 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-29 11:33:41,196 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-29 11:33:41,402 | INFO |     Successfully read prd_info.csv.
2025-06-29 11:33:41,402 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-29 11:33:41,598 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-29 11:33:41,601 | INFO | Attempting to process file: sales_details.csv
2025-06-29 11:33:41,601 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-29 11:33:41,601 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-29 11:33:41,602 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-29 11:33:41,855 | INFO |     Successfully read sales_details.csv.
2025-06-29 11:33:41,856 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-29 11:33:42,573 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-29 11:33:42,573 | INFO | 
Processing folder: source_erp
2025-06-29 11:33:42,574 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-29 11:33:42,574 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-29 11:33:42,574 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-29 11:33:42,575 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 11:33:42,575 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-29 11:33:42,575 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 11:33:42,711 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-29 11:33:42,713 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-29 11:33:42,998 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-29 11:33:42,998 | INFO | Attempting to process file: LOC_A101.csv
2025-06-29 11:33:42,999 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 11:33:42,999 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-29 11:33:42,999 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 11:33:43,126 | INFO |     Successfully read LOC_A101.csv.
2025-06-29 11:33:43,127 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-29 11:33:43,369 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-29 11:33:43,369 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-29 11:33:43,369 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 11:33:43,369 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-29 11:33:43,370 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 11:33:43,457 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-29 11:33:43,457 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-29 11:33:43,547 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-29 11:33:43,547 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-29 11:33:43,547 | INFO | Starting to create empty tables in 'silver' schema...
2025-06-29 11:33:43,547 | INFO | Reading schema from bronze.crm_cust_info...
2025-06-29 11:33:43,569 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-06-29 11:33:43,615 | INFO | Empty table created: silver.crm_cust_info
2025-06-29 11:33:43,615 | INFO | Reading schema from bronze.crm_prd_info...
2025-06-29 11:33:43,632 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-06-29 11:33:43,672 | INFO | Empty table created: silver.crm_prd_info
2025-06-29 11:33:43,672 | INFO | Reading schema from bronze.crm_sales_details...
2025-06-29 11:33:43,689 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-06-29 11:33:43,752 | INFO | Empty table created: silver.crm_sales_details
2025-06-29 11:33:43,752 | INFO | Reading schema from bronze.erp_cust_info...
2025-06-29 11:33:43,768 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-06-29 11:33:43,807 | INFO | Empty table created: silver.erp_cust_info
2025-06-29 11:33:43,807 | INFO | Reading schema from bronze.erp_loc_info...
2025-06-29 11:33:43,823 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-06-29 11:33:43,859 | INFO | Empty table created: silver.erp_loc_info
2025-06-29 11:33:43,860 | INFO | Reading schema from bronze.erp_px_cat...
2025-06-29 11:33:43,875 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-06-29 11:33:43,912 | INFO | Empty table created: silver.erp_px_cat
2025-06-29 11:33:44,214 | INFO | Spark Session stopped.
2025-06-29 16:56:08,489 | INFO | RUN_INGEST is false. Skipping ingestion.
2025-06-29 16:56:26,225 | INFO | RUN_INGEST is false. Skipping ingestion.
2025-06-29 17:03:18,888 | INFO | Starting ETL script.
2025-06-29 17:03:18,889 | INFO | Environment variables loaded successfully.
2025-06-29 17:03:18,889 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-29 17:03:18,953 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-29 17:03:18,953 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-29 17:03:18,953 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-29 17:03:18,953 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-29 17:03:22,896 | INFO | Spark Session created successfully.
2025-06-29 17:03:22,896 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-29 17:03:22,910 | INFO |   spark.app.id: local-1751191401302
2025-06-29 17:03:22,910 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-29 17:03:22,910 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 17:03:22,910 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-29 17:03:22,911 | INFO |   spark.master: local[*]
2025-06-29 17:03:22,911 | INFO |   spark.executor.id: driver
2025-06-29 17:03:22,911 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-29 17:03:22,911 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-29 17:03:22,911 | INFO |   spark.submit.deployMode: client
2025-06-29 17:03:22,911 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-29 17:03:22,912 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-29 17:03:22,912 | INFO |   spark.driver.port: 40849
2025-06-29 17:03:22,912 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-29 17:03:22,912 | INFO |   spark.driver.host: 9b46c2cbfc29
2025-06-29 17:03:22,912 | INFO |   spark.ui.showConsoleProgress: true
2025-06-29 17:03:22,912 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 17:03:22,913 | INFO |   spark.rdd.compress: True
2025-06-29 17:03:22,913 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-29 17:03:22,913 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-29 17:03:22,913 | INFO |   spark.submit.pyFiles: 
2025-06-29 17:03:22,914 | INFO |   spark.app.submitTime: 1751191400551
2025-06-29 17:03:22,914 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-29 17:03:22,914 | INFO |   spark.app.initial.jar.urls: spark://9b46c2cbfc29:40849/jars/postgresql-42.6.0.jar
2025-06-29 17:03:22,914 | INFO |   spark.app.startTime: 1751191400771
2025-06-29 17:03:22,914 | INFO | --- End Spark Configurations ---
2025-06-29 17:03:22,915 | INFO | Starting CSV ingestion...
2025-06-29 17:03:22,915 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-29 17:03:22,915 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-29 17:03:22,915 | INFO | 
Processing folder: source_crm
2025-06-29 17:03:22,915 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-29 17:03:22,917 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-29 17:03:22,917 | INFO | Attempting to process file: cust_info.csv
2025-06-29 17:03:22,917 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-29 17:03:22,917 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-29 17:03:22,917 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-29 17:03:25,097 | INFO |     Successfully read cust_info.csv.
2025-06-29 17:03:25,097 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-29 17:03:26,124 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-29 17:03:26,124 | INFO | Attempting to process file: prd_info.csv
2025-06-29 17:03:26,124 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-29 17:03:26,125 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-29 17:03:26,125 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-29 17:03:26,302 | INFO |     Successfully read prd_info.csv.
2025-06-29 17:03:26,302 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-29 17:03:26,533 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-29 17:03:26,534 | INFO | Attempting to process file: sales_details.csv
2025-06-29 17:03:26,534 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-29 17:03:26,534 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-29 17:03:26,535 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-29 17:03:26,859 | INFO |     Successfully read sales_details.csv.
2025-06-29 17:03:26,859 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-29 17:03:27,610 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-29 17:03:27,610 | INFO | 
Processing folder: source_erp
2025-06-29 17:03:27,610 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-29 17:03:27,611 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-29 17:03:27,611 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-29 17:03:27,612 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 17:03:27,612 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-29 17:03:27,612 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 17:03:27,766 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-29 17:03:27,766 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-29 17:03:28,063 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-29 17:03:28,063 | INFO | Attempting to process file: LOC_A101.csv
2025-06-29 17:03:28,063 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 17:03:28,063 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-29 17:03:28,063 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 17:03:28,201 | INFO |     Successfully read LOC_A101.csv.
2025-06-29 17:03:28,201 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-29 17:03:28,467 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-29 17:03:28,467 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-29 17:03:28,467 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 17:03:28,467 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-29 17:03:28,468 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 17:03:28,574 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-29 17:03:28,574 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-29 17:03:28,703 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-29 17:03:28,704 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-29 17:03:28,704 | INFO | Starting to create empty tables in 'silver' schema...
2025-06-29 17:03:28,705 | INFO | Reading schema from bronze.crm_cust_info...
2025-06-29 17:03:28,727 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-06-29 17:03:28,783 | INFO | Empty table created: silver.crm_cust_info
2025-06-29 17:03:28,783 | INFO | Reading schema from bronze.crm_prd_info...
2025-06-29 17:03:28,803 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-06-29 17:03:28,843 | INFO | Empty table created: silver.crm_prd_info
2025-06-29 17:03:28,843 | INFO | Reading schema from bronze.crm_sales_details...
2025-06-29 17:03:28,861 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-06-29 17:03:28,900 | INFO | Empty table created: silver.crm_sales_details
2025-06-29 17:03:28,900 | INFO | Reading schema from bronze.erp_cust_info...
2025-06-29 17:03:28,915 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-06-29 17:03:28,953 | INFO | Empty table created: silver.erp_cust_info
2025-06-29 17:03:28,953 | INFO | Reading schema from bronze.erp_loc_info...
2025-06-29 17:03:28,970 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-06-29 17:03:29,008 | INFO | Empty table created: silver.erp_loc_info
2025-06-29 17:03:29,008 | INFO | Reading schema from bronze.erp_px_cat...
2025-06-29 17:03:29,024 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-06-29 17:03:29,067 | INFO | Empty table created: silver.erp_px_cat
2025-06-29 17:03:29,598 | INFO | Spark Session stopped.
2025-06-29 21:17:29,032 | INFO | Starting ETL script.
2025-06-29 21:17:29,033 | INFO | Environment variables loaded successfully.
2025-06-29 21:17:29,033 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-29 21:17:29,117 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-29 21:17:29,118 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-29 21:17:29,118 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-29 21:17:29,118 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-29 21:17:33,075 | INFO | Spark Session created successfully.
2025-06-29 21:17:33,075 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-29 21:17:33,085 | INFO |   spark.driver.port: 41417
2025-06-29 21:17:33,085 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-29 21:17:33,086 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 21:17:33,086 | INFO |   spark.app.initial.jar.urls: spark://7eb045e3f4eb:41417/jars/postgresql-42.6.0.jar
2025-06-29 21:17:33,086 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-29 21:17:33,086 | INFO |   spark.master: local[*]
2025-06-29 21:17:33,086 | INFO |   spark.driver.host: 7eb045e3f4eb
2025-06-29 21:17:33,086 | INFO |   spark.executor.id: driver
2025-06-29 21:17:33,086 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-29 21:17:33,086 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-29 21:17:33,087 | INFO |   spark.submit.deployMode: client
2025-06-29 21:17:33,087 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-29 21:17:33,087 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-29 21:17:33,087 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-29 21:17:33,087 | INFO |   spark.ui.showConsoleProgress: true
2025-06-29 21:17:33,087 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-29 21:17:33,087 | INFO |   spark.rdd.compress: True
2025-06-29 21:17:33,087 | INFO |   spark.app.submitTime: 1751206650781
2025-06-29 21:17:33,087 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-29 21:17:33,087 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-29 21:17:33,087 | INFO |   spark.submit.pyFiles: 
2025-06-29 21:17:33,088 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-29 21:17:33,088 | INFO |   spark.app.id: local-1751206651457
2025-06-29 21:17:33,088 | INFO |   spark.app.startTime: 1751206650937
2025-06-29 21:17:33,088 | INFO | --- End Spark Configurations ---
2025-06-29 21:17:33,088 | INFO | Starting CSV ingestion...
2025-06-29 21:17:33,088 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-29 21:17:33,088 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-29 21:17:33,088 | INFO | 
Processing folder: source_crm
2025-06-29 21:17:33,088 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-29 21:17:33,089 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-29 21:17:33,089 | INFO | Attempting to process file: cust_info.csv
2025-06-29 21:17:33,089 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-29 21:17:33,089 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-29 21:17:33,089 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-29 21:17:35,175 | INFO |     Successfully read cust_info.csv.
2025-06-29 21:17:35,175 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-29 21:17:36,061 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-29 21:17:36,062 | INFO | Attempting to process file: prd_info.csv
2025-06-29 21:17:36,062 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-29 21:17:36,062 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-29 21:17:36,062 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-29 21:17:36,191 | INFO |     Successfully read prd_info.csv.
2025-06-29 21:17:36,192 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-29 21:17:36,368 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-29 21:17:36,368 | INFO | Attempting to process file: sales_details.csv
2025-06-29 21:17:36,368 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-29 21:17:36,368 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-29 21:17:36,369 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-29 21:17:36,583 | INFO |     Successfully read sales_details.csv.
2025-06-29 21:17:36,583 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-29 21:17:37,208 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-29 21:17:37,208 | INFO | 
Processing folder: source_erp
2025-06-29 21:17:37,208 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-29 21:17:37,209 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-29 21:17:37,209 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-29 21:17:37,209 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 21:17:37,209 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-29 21:17:37,209 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-29 21:17:37,330 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-29 21:17:37,330 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-29 21:17:37,589 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-29 21:17:37,589 | INFO | Attempting to process file: LOC_A101.csv
2025-06-29 21:17:37,589 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 21:17:37,589 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-29 21:17:37,589 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-29 21:17:37,692 | INFO |     Successfully read LOC_A101.csv.
2025-06-29 21:17:37,693 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-29 21:17:37,933 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-29 21:17:37,934 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-29 21:17:37,935 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 21:17:37,936 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-29 21:17:37,937 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-29 21:17:38,039 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-29 21:17:38,039 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-29 21:17:38,134 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-29 21:17:38,134 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-29 21:17:38,134 | INFO | Starting to create empty tables in 'silver' schema...
2025-06-29 21:17:38,134 | INFO | Reading schema from bronze.crm_cust_info...
2025-06-29 21:17:38,155 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-06-29 21:17:38,205 | INFO | Empty table created: silver.crm_cust_info
2025-06-29 21:17:38,205 | INFO | Reading schema from bronze.crm_prd_info...
2025-06-29 21:17:38,222 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-06-29 21:17:38,261 | INFO | Empty table created: silver.crm_prd_info
2025-06-29 21:17:38,261 | INFO | Reading schema from bronze.crm_sales_details...
2025-06-29 21:17:38,277 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-06-29 21:17:38,327 | INFO | Empty table created: silver.crm_sales_details
2025-06-29 21:17:38,327 | INFO | Reading schema from bronze.erp_cust_info...
2025-06-29 21:17:38,343 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-06-29 21:17:38,381 | INFO | Empty table created: silver.erp_cust_info
2025-06-29 21:17:38,381 | INFO | Reading schema from bronze.erp_loc_info...
2025-06-29 21:17:38,396 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-06-29 21:17:38,439 | INFO | Empty table created: silver.erp_loc_info
2025-06-29 21:17:38,439 | INFO | Reading schema from bronze.erp_px_cat...
2025-06-29 21:17:38,455 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-06-29 21:17:38,490 | INFO | Empty table created: silver.erp_px_cat
2025-06-29 21:17:38,772 | INFO | Spark Session stopped.
2025-06-30 21:27:09,665 | INFO | Starting ETL script.
2025-06-30 21:27:09,665 | INFO | Environment variables loaded successfully.
2025-06-30 21:27:09,665 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-06-30 21:27:09,751 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-06-30 21:27:09,752 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-06-30 21:27:09,752 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-06-30 21:27:09,752 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-06-30 21:27:13,698 | INFO | Spark Session created successfully.
2025-06-30 21:27:13,699 | INFO | Spark Configurations (as seen by SparkContext):
2025-06-30 21:27:13,710 | INFO |   spark.app.id: local-1751293632100
2025-06-30 21:27:13,710 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-06-30 21:27:13,710 | INFO |   spark.app.initial.jar.urls: spark://57a63cea285a:38359/jars/postgresql-42.6.0.jar
2025-06-30 21:27:13,710 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-30 21:27:13,710 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-06-30 21:27:13,711 | INFO |   spark.master: local[*]
2025-06-30 21:27:13,711 | INFO |   spark.driver.host: 57a63cea285a
2025-06-30 21:27:13,711 | INFO |   spark.executor.id: driver
2025-06-30 21:27:13,712 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-06-30 21:27:13,712 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-06-30 21:27:13,712 | INFO |   spark.submit.deployMode: client
2025-06-30 21:27:13,712 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-06-30 21:27:13,712 | INFO |   spark.local.dir: /tmp/spark-temp
2025-06-30 21:27:13,712 | INFO |   spark.serializer.objectStreamReset: 100
2025-06-30 21:27:13,713 | INFO |   spark.app.startTime: 1751293631576
2025-06-30 21:27:13,713 | INFO |   spark.ui.showConsoleProgress: true
2025-06-30 21:27:13,713 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-06-30 21:27:13,713 | INFO |   spark.rdd.compress: True
2025-06-30 21:27:13,714 | INFO |   spark.app.submitTime: 1751293631429
2025-06-30 21:27:13,714 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-06-30 21:27:13,714 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-06-30 21:27:13,714 | INFO |   spark.submit.pyFiles: 
2025-06-30 21:27:13,714 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-06-30 21:27:13,714 | INFO |   spark.driver.port: 38359
2025-06-30 21:27:13,714 | INFO | --- End Spark Configurations ---
2025-06-30 21:27:13,715 | INFO | Starting CSV ingestion...
2025-06-30 21:27:13,715 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-06-30 21:27:13,715 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-06-30 21:27:13,715 | INFO | 
Processing folder: source_crm
2025-06-30 21:27:13,715 | INFO | Full path for current folder: /data/datasets/source_crm
2025-06-30 21:27:13,717 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-06-30 21:27:13,717 | INFO | Attempting to process file: cust_info.csv
2025-06-30 21:27:13,717 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-06-30 21:27:13,717 | INFO |     Targeting database table: bronze.crm_cust_info
2025-06-30 21:27:13,718 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-06-30 21:27:15,736 | INFO |     Successfully read cust_info.csv.
2025-06-30 21:27:15,736 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-06-30 21:27:16,595 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-06-30 21:27:16,595 | INFO | Attempting to process file: prd_info.csv
2025-06-30 21:27:16,596 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-06-30 21:27:16,596 | INFO |     Targeting database table: bronze.crm_prd_info
2025-06-30 21:27:16,596 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-06-30 21:27:16,741 | INFO |     Successfully read prd_info.csv.
2025-06-30 21:27:16,741 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-06-30 21:27:16,909 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-06-30 21:27:16,910 | INFO | Attempting to process file: sales_details.csv
2025-06-30 21:27:16,910 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-06-30 21:27:16,910 | INFO |     Targeting database table: bronze.crm_sales_details
2025-06-30 21:27:16,910 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-06-30 21:27:17,136 | INFO |     Successfully read sales_details.csv.
2025-06-30 21:27:17,136 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-06-30 21:27:17,793 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-06-30 21:27:17,794 | INFO | 
Processing folder: source_erp
2025-06-30 21:27:17,794 | INFO | Full path for current folder: /data/datasets/source_erp
2025-06-30 21:27:17,795 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-06-30 21:27:17,795 | INFO | Attempting to process file: CUST_AZ12.csv
2025-06-30 21:27:17,795 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-30 21:27:17,795 | INFO |     Targeting database table: bronze.erp_cust_info
2025-06-30 21:27:17,795 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-06-30 21:27:17,923 | INFO |     Successfully read CUST_AZ12.csv.
2025-06-30 21:27:17,923 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-06-30 21:27:18,158 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-06-30 21:27:18,158 | INFO | Attempting to process file: LOC_A101.csv
2025-06-30 21:27:18,159 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-06-30 21:27:18,159 | INFO |     Targeting database table: bronze.erp_loc_info
2025-06-30 21:27:18,159 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-06-30 21:27:18,258 | INFO |     Successfully read LOC_A101.csv.
2025-06-30 21:27:18,259 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-06-30 21:27:18,456 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-06-30 21:27:18,456 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-06-30 21:27:18,456 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-30 21:27:18,456 | INFO |     Targeting database table: bronze.erp_px_cat
2025-06-30 21:27:18,457 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-06-30 21:27:18,567 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-06-30 21:27:18,568 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-06-30 21:27:18,679 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-06-30 21:27:18,679 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-06-30 21:27:18,679 | INFO | Starting to create empty tables in 'silver' schema...
2025-06-30 21:27:18,680 | INFO | Reading schema from bronze.crm_cust_info...
2025-06-30 21:27:18,701 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-06-30 21:27:18,747 | INFO | Empty table created: silver.crm_cust_info
2025-06-30 21:27:18,748 | INFO | Reading schema from bronze.crm_prd_info...
2025-06-30 21:27:18,764 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-06-30 21:27:18,802 | INFO | Empty table created: silver.crm_prd_info
2025-06-30 21:27:18,803 | INFO | Reading schema from bronze.crm_sales_details...
2025-06-30 21:27:18,818 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-06-30 21:27:18,856 | INFO | Empty table created: silver.crm_sales_details
2025-06-30 21:27:18,856 | INFO | Reading schema from bronze.erp_cust_info...
2025-06-30 21:27:18,870 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-06-30 21:27:18,904 | INFO | Empty table created: silver.erp_cust_info
2025-06-30 21:27:18,904 | INFO | Reading schema from bronze.erp_loc_info...
2025-06-30 21:27:18,919 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-06-30 21:27:18,963 | INFO | Empty table created: silver.erp_loc_info
2025-06-30 21:27:18,964 | INFO | Reading schema from bronze.erp_px_cat...
2025-06-30 21:27:18,979 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-06-30 21:27:19,016 | INFO | Empty table created: silver.erp_px_cat
2025-06-30 21:27:19,410 | INFO | Spark Session stopped.
2025-07-01 21:35:19,654 | INFO | Starting ETL script.
2025-07-01 21:35:19,656 | INFO | Environment variables loaded successfully.
2025-07-01 21:35:19,656 | INFO | Attempting to connect to PostgreSQL at pgdatabase:5432/sqldatabase
2025-07-01 21:35:19,742 | INFO | Schemas 'bronze' and 'silver' created (or already existed).
2025-07-01 21:35:19,742 | INFO | JDBC driver found at /opt/jars/postgresql-42.6.0.jar.
2025-07-01 21:35:19,742 | INFO | Spark temporary directory /tmp/spark-temp already exists.
2025-07-01 21:35:19,743 | INFO | Spark temporary directory /tmp/spark-temp is writable.
2025-07-01 21:35:23,761 | INFO | Spark Session created successfully.
2025-07-01 21:35:23,761 | INFO | Spark Configurations (as seen by SparkContext):
2025-07-01 21:35:23,771 | INFO |   spark.hadoop.fs.s3a.vectored.read.min.seek.size: 128K
2025-07-01 21:35:23,772 | INFO |   spark.executor.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-07-01 21:35:23,772 | INFO |   spark.sql.artifact.isolation.enabled: false
2025-07-01 21:35:23,772 | INFO |   spark.master: local[*]
2025-07-01 21:35:23,772 | INFO |   spark.app.id: local-1751380522094
2025-07-01 21:35:23,772 | INFO |   spark.driver.port: 43107
2025-07-01 21:35:23,773 | INFO |   spark.executor.id: driver
2025-07-01 21:35:23,773 | INFO |   spark.app.name: ETL CSV to Postgres Local
2025-07-01 21:35:23,773 | INFO |   spark.jars: /opt/jars/postgresql-42.6.0.jar
2025-07-01 21:35:23,773 | INFO |   spark.submit.deployMode: client
2025-07-01 21:35:23,773 | INFO |   spark.sql.session.local.dir: /tmp/spark-temp
2025-07-01 21:35:23,773 | INFO |   spark.local.dir: /tmp/spark-temp
2025-07-01 21:35:23,773 | INFO |   spark.serializer.objectStreamReset: 100
2025-07-01 21:35:23,774 | INFO |   spark.ui.showConsoleProgress: true
2025-07-01 21:35:23,774 | INFO |   spark.driver.extraJavaOptions: -Djava.net.preferIPv6Addresses=false -XX:+IgnoreUnrecognizedVMOptions --add-modules=jdk.incubator.vector --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.invoke=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=java.base/java.net=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.atomic=ALL-UNNAMED --add-opens=java.base/jdk.internal.ref=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/sun.nio.cs=ALL-UNNAMED --add-opens=java.base/sun.security.action=ALL-UNNAMED --add-opens=java.base/sun.util.calendar=ALL-UNNAMED --add-opens=java.security.jgss/sun.security.krb5=ALL-UNNAMED -Djdk.reflect.useDirectMethodHandle=false -Dio.netty.tryReflectionSetAccessible=true -Djava.io.tmpdir=/tmp/spark-temp
2025-07-01 21:35:23,774 | INFO |   spark.rdd.compress: True
2025-07-01 21:35:23,774 | INFO |   spark.app.startTime: 1751380521561
2025-07-01 21:35:23,774 | INFO |   spark.driver.host: 750189bb0981
2025-07-01 21:35:23,774 | INFO |   spark.app.initial.jar.urls: spark://750189bb0981:43107/jars/postgresql-42.6.0.jar
2025-07-01 21:35:23,774 | INFO |   spark.sql.warehouse.dir: /tmp/spark-temp/spark-warehouse
2025-07-01 21:35:23,774 | INFO |   spark.repl.local.jars: file:///opt/jars/postgresql-42.6.0.jar
2025-07-01 21:35:23,775 | INFO |   spark.submit.pyFiles: 
2025-07-01 21:35:23,775 | INFO |   spark.hadoop.fs.s3a.vectored.read.max.merged.size: 2M
2025-07-01 21:35:23,775 | INFO |   spark.app.submitTime: 1751380521393
2025-07-01 21:35:23,775 | INFO | --- End Spark Configurations ---
2025-07-01 21:35:23,775 | INFO | Starting CSV ingestion...
2025-07-01 21:35:23,775 | INFO | Configured Host_datasets_path (inside container): /data/datasets
2025-07-01 21:35:23,776 | INFO | Folders to process: ['source_crm', 'source_erp']
2025-07-01 21:35:23,776 | INFO | 
Processing folder: source_crm
2025-07-01 21:35:23,776 | INFO | Full path for current folder: /data/datasets/source_crm
2025-07-01 21:35:23,777 | INFO | Contents found in /data/datasets/source_crm: ['cust_info.csv', 'prd_info.csv', 'sales_details.csv']
2025-07-01 21:35:23,777 | INFO | Attempting to process file: cust_info.csv
2025-07-01 21:35:23,777 | INFO |     Recognized CSV file: /data/datasets/source_crm/cust_info.csv
2025-07-01 21:35:23,777 | INFO |     Targeting database table: bronze.crm_cust_info
2025-07-01 21:35:23,777 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/cust_info.csv
2025-07-01 21:35:25,841 | INFO |     Successfully read cust_info.csv.
2025-07-01 21:35:25,842 | INFO |     Writing DataFrame to bronze.crm_cust_info (mode: overwrite)
2025-07-01 21:35:26,716 | INFO |     Successfully ingested cust_info.csv to bronze.crm_cust_info
2025-07-01 21:35:26,716 | INFO | Attempting to process file: prd_info.csv
2025-07-01 21:35:26,716 | INFO |     Recognized CSV file: /data/datasets/source_crm/prd_info.csv
2025-07-01 21:35:26,716 | INFO |     Targeting database table: bronze.crm_prd_info
2025-07-01 21:35:26,717 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/prd_info.csv
2025-07-01 21:35:26,876 | INFO |     Successfully read prd_info.csv.
2025-07-01 21:35:26,876 | INFO |     Writing DataFrame to bronze.crm_prd_info (mode: overwrite)
2025-07-01 21:35:27,062 | INFO |     Successfully ingested prd_info.csv to bronze.crm_prd_info
2025-07-01 21:35:27,063 | INFO | Attempting to process file: sales_details.csv
2025-07-01 21:35:27,063 | INFO |     Recognized CSV file: /data/datasets/source_crm/sales_details.csv
2025-07-01 21:35:27,063 | INFO |     Targeting database table: bronze.crm_sales_details
2025-07-01 21:35:27,063 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_crm/sales_details.csv
2025-07-01 21:35:27,292 | INFO |     Successfully read sales_details.csv.
2025-07-01 21:35:27,292 | INFO |     Writing DataFrame to bronze.crm_sales_details (mode: overwrite)
2025-07-01 21:35:27,964 | INFO |     Successfully ingested sales_details.csv to bronze.crm_sales_details
2025-07-01 21:35:27,964 | INFO | 
Processing folder: source_erp
2025-07-01 21:35:27,964 | INFO | Full path for current folder: /data/datasets/source_erp
2025-07-01 21:35:27,965 | INFO | Contents found in /data/datasets/source_erp: ['CUST_AZ12.csv', 'LOC_A101.csv', 'PX_CAT_G1V2.csv']
2025-07-01 21:35:27,965 | INFO | Attempting to process file: CUST_AZ12.csv
2025-07-01 21:35:27,965 | INFO |     Recognized CSV file: /data/datasets/source_erp/CUST_AZ12.csv
2025-07-01 21:35:27,965 | INFO |     Targeting database table: bronze.erp_cust_info
2025-07-01 21:35:27,965 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/CUST_AZ12.csv
2025-07-01 21:35:28,096 | INFO |     Successfully read CUST_AZ12.csv.
2025-07-01 21:35:28,096 | INFO |     Writing DataFrame to bronze.erp_cust_info (mode: overwrite)
2025-07-01 21:35:28,341 | INFO |     Successfully ingested CUST_AZ12.csv to bronze.erp_cust_info
2025-07-01 21:35:28,343 | INFO | Attempting to process file: LOC_A101.csv
2025-07-01 21:35:28,343 | INFO |     Recognized CSV file: /data/datasets/source_erp/LOC_A101.csv
2025-07-01 21:35:28,343 | INFO |     Targeting database table: bronze.erp_loc_info
2025-07-01 21:35:28,343 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/LOC_A101.csv
2025-07-01 21:35:28,503 | INFO |     Successfully read LOC_A101.csv.
2025-07-01 21:35:28,504 | INFO |     Writing DataFrame to bronze.erp_loc_info (mode: overwrite)
2025-07-01 21:35:28,741 | INFO |     Successfully ingested LOC_A101.csv to bronze.erp_loc_info
2025-07-01 21:35:28,741 | INFO | Attempting to process file: PX_CAT_G1V2.csv
2025-07-01 21:35:28,741 | INFO |     Recognized CSV file: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-07-01 21:35:28,741 | INFO |     Targeting database table: bronze.erp_px_cat
2025-07-01 21:35:28,741 | INFO |     Attempting to read CSV file with Spark: /data/datasets/source_erp/PX_CAT_G1V2.csv
2025-07-01 21:35:28,851 | INFO |     Successfully read PX_CAT_G1V2.csv.
2025-07-01 21:35:28,852 | INFO |     Writing DataFrame to bronze.erp_px_cat (mode: overwrite)
2025-07-01 21:35:28,938 | INFO |     Successfully ingested PX_CAT_G1V2.csv to bronze.erp_px_cat
2025-07-01 21:35:28,939 | INFO | All CSVs ingestion process completed (check database for actual data).
2025-07-01 21:35:28,939 | INFO | Starting to create empty tables in 'silver' schema...
2025-07-01 21:35:28,939 | INFO | Reading schema from bronze.crm_cust_info...
2025-07-01 21:35:28,959 | INFO | Writing empty table silver.crm_cust_info with structure only...
2025-07-01 21:35:29,011 | INFO | Empty table created: silver.crm_cust_info
2025-07-01 21:35:29,012 | INFO | Reading schema from bronze.crm_prd_info...
2025-07-01 21:35:29,027 | INFO | Writing empty table silver.crm_prd_info with structure only...
2025-07-01 21:35:29,065 | INFO | Empty table created: silver.crm_prd_info
2025-07-01 21:35:29,066 | INFO | Reading schema from bronze.crm_sales_details...
2025-07-01 21:35:29,081 | INFO | Writing empty table silver.crm_sales_details with structure only...
2025-07-01 21:35:29,134 | INFO | Empty table created: silver.crm_sales_details
2025-07-01 21:35:29,135 | INFO | Reading schema from bronze.erp_cust_info...
2025-07-01 21:35:29,152 | INFO | Writing empty table silver.erp_cust_info with structure only...
2025-07-01 21:35:29,188 | INFO | Empty table created: silver.erp_cust_info
2025-07-01 21:35:29,188 | INFO | Reading schema from bronze.erp_loc_info...
2025-07-01 21:35:29,204 | INFO | Writing empty table silver.erp_loc_info with structure only...
2025-07-01 21:35:29,247 | INFO | Empty table created: silver.erp_loc_info
2025-07-01 21:35:29,247 | INFO | Reading schema from bronze.erp_px_cat...
2025-07-01 21:35:29,263 | INFO | Writing empty table silver.erp_px_cat with structure only...
2025-07-01 21:35:29,298 | INFO | Empty table created: silver.erp_px_cat
2025-07-01 21:35:29,402 | INFO | Spark Session stopped.
2025-07-08 22:58:58,756 | INFO | RUN_INGEST is false. Skipping ingestion.
2025-07-11 17:14:36,070 | INFO | RUN_INGEST is false. Skipping ingestion.
2025-07-13 19:15:03,713 | INFO | RUN_INGEST is false. Skipping ingestion.
